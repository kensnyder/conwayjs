<!DOCTYPE html>
<html>
	<head>
		<title>conwayjs.com | Conway's Game of Life with HTML5 Canvas</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
		<script src="/game.php"></script>
		<link rel="stylesheet" href="/css/game.css" />
	</head>
	<body>
		<div id="board"></div>
		<div id="controls">
			<select id="ruleSelect"></select> &nbsp; &nbsp;
			<input id="seedSelect" type="button" /> &nbsp; &nbsp;
			<input id="startButton" type="button" /> &nbsp; &nbsp;
			<input id="resetButton" type="button" value="Reset" /> &nbsp; &nbsp;
			<input id="saveButton" type="button" value="Save State" /> &nbsp; &nbsp;
			Speed: <select id="intervalSelect"></select> &nbsp; &nbsp;
			Cell Size: <select id="blockSizeSelect"></select> &nbsp; &nbsp;
			Gridlines: <select id="gridlinesSelect"></select> &nbsp; &nbsp;
		</div>
		<div id="panel">
			<header class="panel-header">
				<a class="panel-back" href="#"><span>Back</span></a>
				<a class="panel-close" href="#"><span>X</span></a>
				<img class="panel-logo" src="/img/logo-white.png" width="72" height="16" alt="conwayjs" />
			</header>
			<div id="panel-content-area"></div>
		</div>
		<script>
			var $panel = $('#panel');
			var $panelContent = $('#panel-content-area');
			GameControls.prototype._setupSeedSelect = function() {
				var button = this.elements.seedSelect;
				button.value = 'Pick Shape';
				$(button).click(function() {
					if ($panelContent.html() == '') {						
						$panelContent.html('Loading...').load('/game_shape_categories/browse');
					}
					$panel.show();
				});
			};
			$panel.delegate('.panel-close', 'click', function(evt) {
				evt.preventDefault();
				$panel.hide();
			});
			$panelContent.delegate('.shape .item-nav-link', 'click', function(evt) {
				evt.preventDefault();
				evt.stopImmediatePropagation();
				var href = $(this).prop('href');
				$.ajax({
					url: href
				}).done(function(shape) {
					controls.reset();
					GameShapes.add(controls, shape.spec);
					controls.renderer.draw();
				});
				$panel.hide();
			});
			$panelContent.delegate('.category .item-nav-link', 'click', function(evt) {
				evt.preventDefault();
				console.log(this);
				var href = $(this).prop('href');
				$panelContent.html('Loading...').load(href);
			});
			var controls = new GameControls(
				document.getElementById('controls'),
				document.getElementById('board')
			);
		</script>
	</body>
</html>
